{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shipment Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <h3 class="mb-4 text-center"><b><u>Shipment Details</u></b></h3>

    <!-- Shipment Info -->
    <table class="table table-bordered">
        <tr><th>Trip No.</th><td>{{ shipment.trip_no }}</td></tr>
        <tr><th>Date</th><td>{{ shipment.date }}</td></tr>
        <tr><th>Vehicle No</th><td>{{ shipment.vehicle_no }}</td></tr>
        <tr><th>From</th><td>{{ shipment.origin }}</td></tr>
        <tr><th>To</th><td>{{ shipment.destination }}</td></tr>
        <tr><th>Item</th><td>{{ shipment.item }}</td></tr>
        <tr><th>Qty</th><td>{{ shipment.qty }}</td></tr>
        <tr><th>Fuel (Ltr)</th><td>{{ shipment.fuel_ltr }}</td></tr>
    </table>

    <!-- Variable Costs -->
    <h4>Variable Costs</h4>
    {% if variable_cost %}
    <table class="table table-bordered">
        <tr><th>Fare</th><td>{{ variable_cost.fare }}</td></tr>
        <tr><th>Recovery Fare</th><td>{{ variable_cost.recovery_fare }}</td></tr>
        <tr><th>Fuel (TK)</th><td>{{ variable_cost.fuel_tk }}</td></tr>
        <tr><th>Toll</th><td>{{ variable_cost.toll }}</td></tr>
        <tr><th>Food</th><td>{{ variable_cost.food }}</td></tr>
        <tr><th>Repair</th><td>{{ variable_cost.repair }}</td></tr>
        <tr><th>Police</th><td>{{ variable_cost.police }}</td></tr>
        <tr><th>Without doc.</th><td>{{ variable_cost.without_doc }}</td></tr>
        <tr><th>Total Variable Cost</th><td>{{ variable_total }}</td></tr>
    </table>
    {% else %}
    <p class="text-muted">Variable costs not entered.</p>
    {% endif %}

    <!-- Fixed Costs -->
<!-- Fixed Costs -->
<h4>Fixed Costs</h4>
<table class="table table-bordered">
    {% for fc in shipment.fixed_costs.all %}
        <tr>
            <th>{{ fc.name|title }}</th>
            <td>
                {% if fc.name == "salary" %}
                    {{ shipment.prorated_salary|floatformat:2 }}
                {% elif fc.name == "insurance" %}
                    {{ shipment.prorated_insurance|floatformat:2 }}
                
                    {% elif fc.name == "depriciation" %}
                    {{ shipment.prorated_depriciation|floatformat:2 }}
                
                {% else %}
                    {{ fc.value }}
                {% endif %}
            </td>
        </tr>
    {% empty %}
        <tr><td colspan="2" class="text-center">No Fixed Costs Set</td></tr>
    {% endfor %}
    <tr>
        <th>Total Fixed Cost</th>
        <td>
            {% with total=0 %}
                {% for fc in shipment.fixed_costs.all %}
                    {% if fc.name == "salary" %}
                        {% with total=total|add:shipment.prorated_salary %}{% endwith %}
                    {% elif fc.name == "insurance" %}
                        {% with total=total|add:shipment.prorated_insurance %}{% endwith %}
                    {% else %}
                        {% with total=total|add:fc.value %}{% endwith %}
                    {% endif %}
                {% endfor %}
                {{ total|floatformat:2 }}
            {% endwith %}
        </td>
    </tr>
</table>




    <!-- Grand Total -->
    <h4>Grand Total Cost: {{ grand_total }}</h4>

    <a href="{% url 'shipment_list' %}" class="btn btn-info">Back to List</a>
</div>
</body>
</html>
